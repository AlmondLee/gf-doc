>[danger] # gproc

```gproc```包用于进程管理以及进程间的通信，其中进程间通信使用的是```fsnotify```+```文件锁```+```共享文件```机制实现。


使用方式：
```go
import "gitee.com/johng/gf/g/os/gproc"
```

方法列表：godoc.org/github.com/johng-cn/gf/g/os/gproc
```go
func Exited() bool
func IsChild() bool
func PPid() int
func PPidOS() int
func Pid() int
func Send(pid int, data interface{}) error
func SetExited()
func StartTime() time.Time
func Uptime() int
type Manager
    func NewManager() *Manager
    func (m *Manager) AddProcess(pid int)
    func (m *Manager) Clear()
    func (m *Manager) GetProcess(pid int) *Process
    func (m *Manager) KillAll() error
    func (m *Manager) NewProcess(path string, args []string, environment []string) *Process
    func (m *Manager) Pids() []int
    func (m *Manager) Processes() []*Process
    func (m *Manager) RemoveProcess(pid int)
    func (m *Manager) Send(data interface{}) error
    func (m *Manager) SendTo(pid int, data interface{}) error
    func (m *Manager) SignalAll(sig os.Signal) error
    func (m *Manager) Size() int
    func (m *Manager) WaitAll()
type Msg
    func Receive() *Msg
type Process
    func NewProcess(path string, args []string, environment []string) *Process
    func (p *Process) Kill() error
    func (p *Process) Pid() int
    func (p *Process) Release() error
    func (p *Process) Run() error
    func (p *Process) Send(data interface{}) error
    func (p *Process) Signal(sig os.Signal) error
    func (p *Process) Start() (int, error)
```

>[success] ## 进程管理

### 主进程与子进程
```go
package main

import (
    "os"
    "time"
    "gitee.com/johng/gf/g/os/glog"
    "gitee.com/johng/gf/g/os/gproc"
)

func main () {
    if gproc.IsChild() {
        glog.Printfln("%d: Hi, I am child, waiting 3 seconds to die", gproc.Pid())
        time.Sleep(time.Second)
        glog.Printfln("%d: 1", gproc.Pid())
        time.Sleep(time.Second)
        glog.Printfln("%d: 2", gproc.Pid())
        time.Sleep(time.Second)
        glog.Printfln("%d: 3", gproc.Pid())
    } else {
        m := gproc.NewManager()
        p := m.NewProcess(os.Args[0], os.Args, os.Environ())
        p.Start()
        p.Wait()
        glog.Printfln("%d: child died", gproc.Pid())
    }
}
```
执行后，终端打印结果如下：
```shell
2018-05-18 14:35:41.360 28285: Hi, I am child, waiting 3 seconds to die
2018-05-18 14:35:42.361 28285: 1
2018-05-18 14:35:43.361 28285: 2
2018-05-18 14:35:44.361 28285: 3
2018-05-18 14:35:44.362 28278: child died
```













