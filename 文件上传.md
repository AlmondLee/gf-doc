>[danger] # 文件上传

文件上传的功能比较常用，我们来看一个使用gf框架的Web Server服务端处理文件上传的例子：

gitee.com/johng/gf/blob/master/geg/frame/mvc/controller/demo/upload.go

```go
package demo

import (
    "gitee.com/johng/gf/g/os/gfile"
    "gitee.com/johng/gf/g/net/ghttp"
)

func Upload(r *ghttp.Request) {
    if f, h, e := r.FormFile("upload-file"); e == nil {
        defer f.Close()
        fname  := gfile.Basename(h.Filename)
        buffer := make([]byte, h.Size)
        f.Read(buffer)
        gfile.PutBinContents("/tmp/" + fname, buffer)
        r.Response.Write(fname + " uploaded successly"))
    } else {
        r.Response.Write(e.Error())
    }
}

func UploadShow(r *ghttp.Request) {
    r.Response.Write(`
<html>
<head>
    <title>上传文件</title>
</head>
    <body>
        <form enctype="multipart/form-data" action="/upload" method="post">
            <input type="file" name="upload-file" />
            <input type="submit" value="upload" />
        </form>
    </body>
</html>
`)
}

func init() {
    ghttp.GetServer().BindHandler("/upload",      Upload)
    ghttp.GetServer().BindHandler("/upload/show", UploadShow)
}
```

访问 ```http://127.0.0.1:8199/upload/show``` 选择需要上传的文件，提交之后可以看到文件上传成功到服务器上。

文件上传比较简单，**但是需要注意的是，服务端在上传处理中需要使用f.Close() 关闭掉临时上传文件指针**。